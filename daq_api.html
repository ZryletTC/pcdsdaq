

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Daq API &mdash; pcdsdaq 2.2.0+18.g630b322 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pcdsdaq.daq.get_daq" href="generated/pcdsdaq.daq.get_daq.html" />
    <link rel="prev" title="Configuration" href="daq_config.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pcdsdaq
          

          
          </a>

          
            
            
              <div class="version">
                2.2.0+18.g630b322
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Running the DAQ</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="daq_basic.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="daq_config.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Daq API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/pcdsdaq.daq.get_daq.html">pcdsdaq.daq.get_daq</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/pcdsdaq.daq.register_daq.html">pcdsdaq.daq.register_daq</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/pcdsdaq.daq.check_connect.html">pcdsdaq.daq.check_connect</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Getting AMI Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ami_basic.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="ami_api.html">AmiDet API</a></li>
</ul>
<p class="caption"><span class="caption-text">Bluesky Plans</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plans_basic.html">Using the DAQ with Bluesky</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessors_api.html">Preprocessors API</a></li>
</ul>
<p class="caption"><span class="caption-text">Auxiliary Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scan_pvs.html">Scan PVs</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
</ul>
<p class="caption"><span class="caption-text">Sim Mode</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sim.html">Simulated DAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="env.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pcdsdaq</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Daq API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/daq_api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="daq-api">
<h1>Daq API<a class="headerlink" href="#daq-api" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pcdsdaq.daq.Daq">
<em class="property">class </em><code class="descclassname">pcdsdaq.daq.</code><code class="descname">Daq</code><span class="sig-paren">(</span><em>RE=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq" title="Permalink to this definition">¶</a></dt>
<dd><p>The LCLS1 daq as a <code class="docutils literal notranslate"><span class="pre">bluesky</span></code>-compatible object.</p>
<p>This uses the <code class="docutils literal notranslate"><span class="pre">pydaq</span></code> module to connect with a running daq instance,
controlling it via socket commands.</p>
<p>It can be used as a <code class="docutils literal notranslate"><span class="pre">Reader</span></code> in a <code class="docutils literal notranslate"><span class="pre">bluesky</span></code> plan to take data at
discrete scan points.</p>
<p>It can be used as a <code class="docutils literal notranslate"><span class="pre">Flyer</span></code> in a <code class="docutils literal notranslate"><span class="pre">bluesky</span></code> plan to have the daq start
at the beginning of the run and end at the end of the run.</p>
<p>Unlike normal <code class="docutils literal notranslate"><span class="pre">bluesky</span></code> readable devices or flyers, this has no data to
report to the <code class="docutils literal notranslate"><span class="pre">RunEngine</span></code> on the <code class="docutils literal notranslate"><span class="pre">read</span></code> or <code class="docutils literal notranslate"><span class="pre">collect</span></code> calls. No data
will pass into the python layer from the daq.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>RE</strong> (<code class="docutils literal notranslate"><span class="pre">RunEngine</span></code>, optional) – Set <code class="docutils literal notranslate"><span class="pre">RE</span></code> to the session’s main <code class="docutils literal notranslate"><span class="pre">RunEngine</span></code></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pcdsdaq.daq.Daq.begin">
<code class="descname">begin</code><span class="sig-paren">(</span><em>events=None</em>, <em>duration=None</em>, <em>record=None</em>, <em>use_l3t=None</em>, <em>controls=None</em>, <em>wait=False</em>, <em>end_run=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the daq and block until the daq has begun acquiring data.</p>
<p>Optionally block with <code class="docutils literal notranslate"><span class="pre">wait=True</span></code> until the daq has finished aquiring
data. If blocking, a <code class="docutils literal notranslate"><span class="pre">ctrl+c</span></code> will end the run and clean up.</p>
<p>If omitted, any argument that is shared with <a class="reference internal" href="#pcdsdaq.daq.Daq.configure" title="pcdsdaq.daq.Daq.configure"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">configure</span></code></a>
will fall back to the configured value.</p>
<p>Internally, this calls <a class="reference internal" href="#pcdsdaq.daq.Daq.kickoff" title="pcdsdaq.daq.Daq.kickoff"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">kickoff</span></code></a> and manages its <code class="docutils literal notranslate"><span class="pre">Status</span></code> object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>events</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) – Number events to take in the daq.</li>
<li><strong>duration</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) – Time to run the daq in seconds, if <code class="docutils literal notranslate"><span class="pre">events</span></code> was not provided.</li>
<li><strong>record</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, we’ll configure the daq to record data before this
run.</li>
<li><strong>use_l3t</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, we’ll run with the level 3 trigger. This means that
if we specified a number of events, we will wait for that many
“good” events as determined by the daq.</li>
<li><strong>controls</strong> (<code class="docutils literal notranslate"><span class="pre">dict{name:</span> <span class="pre">device}</span></code> or <code class="docutils literal notranslate"><span class="pre">list[device...]</span></code>, optional) – If provided, values from these will make it into the DAQ data
stream as variables. We will check <code class="docutils literal notranslate"><span class="pre">device.position</span></code> and
<code class="docutils literal notranslate"><span class="pre">device.value</span></code> for quantities to use and we will update these
values each time begin is called. To provide a list, all devices
must have a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute.</li>
<li><strong>wait</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, wait for the daq to finish aquiring data. A
<code class="docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code> (<code class="docutils literal notranslate"><span class="pre">ctrl+c</span></code>) during this wait will end the
run and clean up.</li>
<li><strong>end_run</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, we’ll end the run after the daq has stopped.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.begin_infinite">
<code class="descname">begin_infinite</code><span class="sig-paren">(</span><em>record=None</em>, <em>use_l3t=None</em>, <em>controls=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.begin_infinite" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the daq to run forever in the background.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.collect">
<code class="descname">collect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect data as part of the <code class="docutils literal notranslate"><span class="pre">bluesky</span></code> <code class="docutils literal notranslate"><span class="pre">Flyer</span></code> interface.</p>
<p>As per the <code class="docutils literal notranslate"><span class="pre">bluesky</span></code> interface, this is a generator that is expected
to output partial event documents. However, since we don’t have any
events to report to python, this will be a generator that immediately
ends.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.complete">
<code class="descname">complete</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.complete" title="Permalink to this definition">¶</a></dt>
<dd><p>If the daq is freely running, this will <a class="reference internal" href="#pcdsdaq.daq.Daq.stop" title="pcdsdaq.daq.Daq.stop"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">stop</span></code></a> the daq.
Otherwise, we’ll simply collect the end_status object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>end_status</strong> – <code class="docutils literal notranslate"><span class="pre">Status</span></code> that will be marked as done when the DAQ has finished
acquiring</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">Status</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pcdsdaq.daq.Daq.config">
<code class="descname">config</code><a class="headerlink" href="#pcdsdaq.daq.Daq.config" title="Permalink to this definition">¶</a></dt>
<dd><p>The current configuration, e.g. the last call to <a class="reference internal" href="#pcdsdaq.daq.Daq.configure" title="pcdsdaq.daq.Daq.configure"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">configure</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.config_info">
<code class="descname">config_info</code><span class="sig-paren">(</span><em>config=None</em>, <em>header='Config:'</em><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.config_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the config information as a logger.info message.</p>
<p>This will print to the screen if the logger is configured correctly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>config</strong> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>, optional) – The configuration to show. If omitted, we’ll use the current
config.</li>
<li><strong>header</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) – A prefix for the config line.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.configure">
<code class="descname">configure</code><span class="sig-paren">(</span><em>events=None</em>, <em>duration=None</em>, <em>record=None</em>, <em>use_l3t=None</em>, <em>controls=None</em>, <em>begin_sleep=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.configure" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the daq’s configuration for the next run.</p>
<p>This is the method that directly interfaces with the daq. If you simply
want to get a configuration ready for later, use <a class="reference internal" href="#pcdsdaq.daq.Daq.preconfig" title="pcdsdaq.daq.Daq.preconfig"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">preconfig</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>events</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) – If provided, the daq will run for this many events before
stopping, unless we override in <a class="reference internal" href="#pcdsdaq.daq.Daq.begin" title="pcdsdaq.daq.Daq.begin"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">begin</span></code></a>.
If not provided, we’ll use the <code class="docutils literal notranslate"><span class="pre">duration</span></code> argument instead.</li>
<li><strong>duration</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) – If provided, the daq will run for this many seconds before
stopping, unless we override in <a class="reference internal" href="#pcdsdaq.daq.Daq.begin" title="pcdsdaq.daq.Daq.begin"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">begin</span></code></a>.
If not provided, and <code class="docutils literal notranslate"><span class="pre">events</span></code> was also not provided, an empty
call like <code class="docutils literal notranslate"><span class="pre">begin()</span></code> will run indefinitely.</li>
<li><strong>record</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, we’ll record the data. Otherwise, we’ll run without
recording. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or the last set value for
<code class="docutils literal notranslate"><span class="pre">record</span></code>.</li>
<li><strong>use_l3t</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, an <code class="docutils literal notranslate"><span class="pre">events</span></code> argument to begin will be reinterpreted
to only count events that pass the level 3 trigger. Defaults to
its last configured value, or <code class="docutils literal notranslate"><span class="pre">False</span></code>.</li>
<li><strong>controls</strong> (<code class="docutils literal notranslate"><span class="pre">dict{name:</span> <span class="pre">device}</span></code> or <code class="docutils literal notranslate"><span class="pre">list[device...]</span></code>, optional) – If provided, values from these will make it into the DAQ data
stream as variables. We will check <code class="docutils literal notranslate"><span class="pre">device.position</span></code> and
<code class="docutils literal notranslate"><span class="pre">device.value</span></code> for quantities to use and we will update these
values each time begin is called. To provide a list, all devices
must have a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute.</li>
<li><strong>begin_sleep</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, optional) – The amount of time to wait after the DAQ returns begin is done.
This is a hack because the DAQ often says that a begin transition
is done without actually being done, so it needs a short delay.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>old, new</strong> – The old configuration and the new configuration. These dictionaries
are verbose, containing all configuration values and the timestamps
at which they were configured, as specified by <code class="docutils literal notranslate"><span class="pre">bluesky</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><code class="docutils literal notranslate"><span class="pre">tuple</span></code> of <code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pcdsdaq.daq.Daq.configured">
<code class="descname">configured</code><a class="headerlink" href="#pcdsdaq.daq.Daq.configured" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the daq is configured, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.connect">
<code class="descname">connect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to the live DAQ, giving full control to the Python process.</p>
<p>To undo this, you may call <a class="reference internal" href="#pcdsdaq.daq.Daq.disconnect" title="pcdsdaq.daq.Daq.disconnect"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">disconnect</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pcdsdaq.daq.Daq.connected">
<code class="descname">connected</code><a class="headerlink" href="#pcdsdaq.daq.Daq.connected" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the daq is connected, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.describe">
<code class="descname">describe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.describe" title="Permalink to this definition">¶</a></dt>
<dd><p>Explain what read returns. There is nothing  yet.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.describe_collect">
<code class="descname">describe_collect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.describe_collect" title="Permalink to this definition">¶</a></dt>
<dd><p>As per the <code class="docutils literal notranslate"><span class="pre">bluesky</span></code> interface, this is how you interpret the null
data from <a class="reference internal" href="#pcdsdaq.daq.Daq.collect" title="pcdsdaq.daq.Daq.collect"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">collect</span></code></a>. There isn’t anything here, as nothing will be
collected.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.describe_configuration">
<code class="descname">describe_configuration</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.describe_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">bluesky</span></code> interface for describing how to interpret the configured
values</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>config_desc</strong> – Mapping of config key to field metadata.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">dict</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.disconnect">
<code class="descname">disconnect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.disconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Disconnect from the live DAQ, giving control back to the GUI.</p>
<p>This is the opposite of <a class="reference internal" href="#pcdsdaq.daq.Daq.connect" title="pcdsdaq.daq.Daq.connect"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">connect</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.end_run">
<code class="descname">end_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.end_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Call <a class="reference internal" href="#pcdsdaq.daq.Daq.stop" title="pcdsdaq.daq.Daq.stop"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">stop</span></code></a>, then mark the run as finished.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.kickoff">
<code class="descname">kickoff</code><span class="sig-paren">(</span><em>events=None</em>, <em>duration=None</em>, <em>use_l3t=None</em>, <em>controls=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.kickoff" title="Permalink to this definition">¶</a></dt>
<dd><p>Begin acquisition. This method is non-blocking.
See <a class="reference internal" href="#pcdsdaq.daq.Daq.begin" title="pcdsdaq.daq.Daq.begin"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">begin</span></code></a> for a description of the parameters.</p>
<p>This method does not supply arguments for configuration parameters, it
supplies arguments directly to <code class="docutils literal notranslate"><span class="pre">pydaq.Control.begin</span></code>. It will
configure before running if there are queued configuration changes.</p>
<p>This is part of the <code class="docutils literal notranslate"><span class="pre">bluesky</span></code> <code class="docutils literal notranslate"><span class="pre">Flyer</span></code> interface.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ready_status</strong> – <code class="docutils literal notranslate"><span class="pre">Status</span></code> that will be marked as done when the daq has begun.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">Status</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pcdsdaq.daq.Daq.next_config">
<code class="descname">next_config</code><a class="headerlink" href="#pcdsdaq.daq.Daq.next_config" title="Permalink to this definition">¶</a></dt>
<dd><p>The next queued configuration.</p>
<p>This can be different than <a class="reference internal" href="#pcdsdaq.daq.Daq.config" title="pcdsdaq.daq.Daq.config"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">config</span></code></a> if we have queued up a
configuration to be run on the next begin.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.pause">
<code class="descname">pause</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.pause" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">bluesky</span></code> interface for determining what to do when a plan is
interrupted. This will call <a class="reference internal" href="#pcdsdaq.daq.Daq.stop" title="pcdsdaq.daq.Daq.stop"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">stop</span></code></a>, but it will not call <a class="reference internal" href="#pcdsdaq.daq.Daq.end_run" title="pcdsdaq.daq.Daq.end_run"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">end_run</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.preconfig">
<code class="descname">preconfig</code><span class="sig-paren">(</span><em>events=None</em>, <em>duration=None</em>, <em>record=None</em>, <em>use_l3t=None</em>, <em>controls=None</em>, <em>begin_sleep=None</em>, <em>show_queued_cfg=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.preconfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Queue configuration parameters for next call to <a class="reference internal" href="#pcdsdaq.daq.Daq.configure" title="pcdsdaq.daq.Daq.configure"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">configure</span></code></a>.</p>
<p>These will be overridden by arguments passed directly to <a class="reference internal" href="#pcdsdaq.daq.Daq.configure" title="pcdsdaq.daq.Daq.configure"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">configure</span></code></a>.
These will be cleared after each call to <a class="reference internal" href="#pcdsdaq.daq.Daq.configure" title="pcdsdaq.daq.Daq.configure"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">configure</span></code></a>.</p>
<p>This can be used to <a class="reference internal" href="#pcdsdaq.daq.Daq.configure" title="pcdsdaq.daq.Daq.configure"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">configure</span></code></a> the <a class="reference internal" href="#pcdsdaq.daq.Daq" title="pcdsdaq.daq.Daq"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Daq</span></code></a> object without connecting.</p>
<p>This will display the next queued configuration using logger.info,
assuming the logger has been configured.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.read">
<code class="descname">read</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Return data. There is no data implemented yet.</p>
<p>This also stops if running so you can use this device in a bluesky scan
and wait for “everything else” to be done, then stop the daq
afterwards.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.read_configuration">
<code class="descname">read_configuration</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.read_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">bluesky</span></code> interface for checking the current configuration</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>config</strong> – Mapping of config key to current configured value and timestamp
when it was last set.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">dict</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pcdsdaq.daq.Daq.record">
<code class="descname">record</code><a class="headerlink" href="#pcdsdaq.daq.Daq.record" title="Permalink to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, we’ll configure the daq to record data. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, we
will configure the daq to not record data.</p>
<p>Setting this is the equivalent of scheduling a <a class="reference internal" href="#pcdsdaq.daq.Daq.configure" title="pcdsdaq.daq.Daq.configure"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">configure</span></code></a> call to be
executed later, e.g. <code class="docutils literal notranslate"><span class="pre">configure(record=True)</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.resume">
<code class="descname">resume</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.resume" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">bluesky</span></code> interface for determining what to do when an interrupted
plan is resumed. This will call <a class="reference internal" href="#pcdsdaq.daq.Daq.begin" title="pcdsdaq.daq.Daq.begin"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">begin</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.run_number">
<code class="descname">run_number</code><span class="sig-paren">(</span><em>hutch_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.run_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the run number of the last run, or current run if running.</p>
<p>This requires you to be on an NFS-mounted host. If hutch can be
determined from the get_hutch_name script from engineering_tools, then
you don’t need to pass in a hutch name.</p>
<p>This is a method and not a property because all properties are
run when you try to tab complete, and this isn’t necessarily an
instant check. It can also display log messages, which would be
annoying on tab complete.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>hutch_name</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) – The hutch to check the run number for. If omitted, we’ll guess
the hutch based on your session details.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>run_number</strong> – The current run number, or previous run if not recording.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li>RuntimeError: – if we have no access to NFS</li>
<li>ValueError: – if an invalid hutch was passed</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.set_filter">
<code class="descname">set_filter</code><span class="sig-paren">(</span><em>*args</em>, <em>event_codes=None</em>, <em>operator='&amp;'</em>, <em>or_bykik=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.set_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the l3t filters.</p>
<p>These connect through pyami to call set_l3t or clear_l3t. The function
takes in arbitrary dets whose prefixes are the ami names, along with low
and highs.</p>
<p>Event codes are handled as a special case, since you always want high vs
low.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By default this will treat bykik at an l3t pass! This is so you don’t
lose your off shots when the l3t trigger is in veto mode. You can
disable this with <code class="docutils literal notranslate"><span class="pre">or_bykik=False</span></code>, but this will remain the default
behavior for backwards compatibility and to prevent someone from losing
shots that they wanted in the data.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>*args</strong> ((<a class="reference internal" href="ami_api.html#pcdsdaq.ami.AmiDet" title="pcdsdaq.ami.AmiDet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">AmiDet</span></code></a>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>) n times) – A sequence of (detector, low, high), which create filters that make
sure the detector is between low and high. You can omit the first
<a class="reference internal" href="ami_api.html#pcdsdaq.ami.AmiDet" title="pcdsdaq.ami.AmiDet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">AmiDet</span></code></a> as a shorthand for the current monitor, assuming a monitor has
been set with <a class="reference internal" href="#pcdsdaq.daq.Daq.set_monitor" title="pcdsdaq.daq.Daq.set_monitor"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Daq.set_monitor</span></code></a> or <a class="reference internal" href="generated/pcdsdaq.ami.set_monitor_det.html#pcdsdaq.ami.set_monitor_det" title="pcdsdaq.ami.set_monitor_det"><code class="xref any py py-func docutils literal notranslate"><span class="pre">set_monitor_det</span></code></a>.</li>
<li><strong>event_codes</strong> (<code class="docutils literal notranslate"><span class="pre">list</span></code>, optional) – A list of event codes to include in the filter. l3pass will be when the
event code is present.</li>
<li><strong>operator</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code>, optional) – The operator for combining the detector ranges and event codes. This
can either be <code class="docutils literal notranslate"><span class="pre">|</span></code> to <code class="docutils literal notranslate"><span class="pre">or</span></code> the conditions together, so l3pass will
happen if any filter passes, or it can be left at the default <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> to
<code class="docutils literal notranslate"><span class="pre">and</span></code> the conditions together, so l3pass will only happen if all
filters pass.</li>
<li><strong>or_bykik</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) – True by default, appends an <code class="docutils literal notranslate"><span class="pre">or</span></code> condition that marks l3t pass when
we see the bykik event code. This makes sure the off shots make it into
the data if we’re in l3t veto mode.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.set_monitor">
<code class="descname">set_monitor</code><span class="sig-paren">(</span><em>det</em><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.set_monitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Designate one <a class="reference internal" href="ami_api.html#pcdsdaq.ami.AmiDet" title="pcdsdaq.ami.AmiDet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">AmiDet</span></code></a> as the monitor.</p>
<p>The monitor det is the default normalization detector and the default
filtering detector when no detector is provided.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>det</strong> (<a class="reference internal" href="ami_api.html#pcdsdaq.ami.AmiDet" title="pcdsdaq.ami.AmiDet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">AmiDet</span></code></a> or <code class="docutils literal notranslate"><span class="pre">bool</span></code>) – The detector to set as the monitor. Alternatively, pass in <code class="docutils literal notranslate"><span class="pre">False</span></code> to
disable the monitor det.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.stage">
<code class="descname">stage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.stage" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">bluesky</span></code> interface for preparing a device for action.</p>
<p>This sets up the daq to end runs on run stop documents.
It also caches the current state, so we know what state to return to
after the <code class="docutils literal notranslate"><span class="pre">bluesky</span></code> scan.
If a run is already started, we’ll end it here so that we can start a
new run during the scan.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>staged</strong> – list of devices staged</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">list</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pcdsdaq.daq.Daq.state">
<code class="descname">state</code><a class="headerlink" href="#pcdsdaq.daq.Daq.state" title="Permalink to this definition">¶</a></dt>
<dd><p>No active session in python
- <code class="docutils literal notranslate"><span class="pre">Connected</span></code>:    Active session in python
- <code class="docutils literal notranslate"><span class="pre">Configured</span></code>:   Connected, and the daq has been configured
- <code class="docutils literal notranslate"><span class="pre">Open</span></code>:         We are in the middle of a run
- <code class="docutils literal notranslate"><span class="pre">Running</span></code>:      We are collecting data in a run</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><p class="first">State as reported by the daq. Can be any of the following</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Type:</th><td class="field-body"><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">Disconnected</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop the current acquisition, ending it early.</p>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.trigger">
<code class="descname">trigger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.trigger" title="Permalink to this definition">¶</a></dt>
<dd><p>Begin acquisition. This method blocks until the run begins.</p>
<p>Returns a status object that will be marked done when the daq has
stopped acquiring.</p>
<p>This will raise a RuntimeError if the daq was never configured for
events or duration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>done_status</strong> – <code class="docutils literal notranslate"><span class="pre">Status</span></code> that will be marked as done when the daq has begun.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">Status</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.unstage">
<code class="descname">unstage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.unstage" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">bluesky</span></code> interface for undoing the <a class="reference internal" href="#pcdsdaq.daq.Daq.stage" title="pcdsdaq.daq.Daq.stage"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">stage</span></code></a> routine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>unstaged</strong> – list of devices unstaged</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">list</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pcdsdaq.daq.Daq.wait">
<code class="descname">wait</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pcdsdaq.daq.Daq.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Pause the thread until the DAQ is done aquiring.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timeout</strong> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) – Maximum time to wait in seconds.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/pcdsdaq.daq.get_daq.html#pcdsdaq.daq.get_daq" title="pcdsdaq.daq.get_daq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_daq</span></code></a></td>
<td>Called by other modules to get the registered <a class="reference internal" href="#pcdsdaq.daq.Daq" title="pcdsdaq.daq.Daq"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Daq</span></code></a> instance.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/pcdsdaq.daq.register_daq.html#pcdsdaq.daq.register_daq" title="pcdsdaq.daq.register_daq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_daq</span></code></a></td>
<td>Called by <a class="reference internal" href="#pcdsdaq.daq.Daq" title="pcdsdaq.daq.Daq"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Daq</span></code></a> at the end of <code class="docutils literal notranslate"><span class="pre">__init__</span></code> to save our one daq instance as the real <a class="reference internal" href="#pcdsdaq.daq.Daq" title="pcdsdaq.daq.Daq"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Daq</span></code></a>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/pcdsdaq.daq.check_connect.html#pcdsdaq.daq.check_connect" title="pcdsdaq.daq.check_connect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_connect</span></code></a></td>
<td>Decorator to ensure that the <a class="reference internal" href="#pcdsdaq.daq.Daq" title="pcdsdaq.daq.Daq"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Daq</span></code></a> is connected before running a method.</td>
</tr>
</tbody>
</table>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="generated/pcdsdaq.daq.get_daq.html" class="btn btn-neutral float-right" title="pcdsdaq.daq.get_daq" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="daq_config.html" class="btn btn-neutral" title="Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>